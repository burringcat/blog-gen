Add 2 Factor Authentication to Linux Login
<b>PAM</b>
Linux uses PAM for user authentication, so look at your <b>/etc/pam.d/common-auth</b> file, and you'll see the <b>pam_unix.so</b> library which is the default unix password auth library.

To chain authentication methods, set the last method to sufficient and all others to required.

Before we change the configuration, be sure to keep an active session, b/c you won't be able to login if you make some mistake.

<b>Google Authenticatior PAM Library</b>
On debian, run

<pre>sudo apt-get install libpam-google-authenticator -y</pre>

And add this:

<pre>auth sufficient pam_google_authenticator.so</pre>

after <b>pam_unix.so</b> to <b>/etc/pam.d/common-auth</b>, and change the necessity of the pam_unix.so to <b>required</b>.

The config will look like this:

# /etc/pam.d/common-auth

auth required pam_unix.so nullok_secure
auth sufficient pam_google_authenticator.so
...


Finally, run <b>google-authenticator</b> to generate a TOTP token url, and you can use any authenticator for it(I recommend <a href="https://github.com/tadfisher/pass-otp">pass-otp</a>).

Try to login again, it should ask for OTP after the password.
